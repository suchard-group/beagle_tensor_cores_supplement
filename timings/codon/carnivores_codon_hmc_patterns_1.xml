<beast>
	
	
	
	<taxa id="taxa">
		<taxon id="Acinonyx jubatus" />
		<taxon id="Ailuropoda melanoleuca" />
		<taxon id="Ailurus fulgens" />
		<taxon id="Alopex lagopus" />
		<taxon id="Arctocephalus australis" />
		<taxon id="Arctocephalus forsteri" />
		<taxon id="Arctocephalus pusillus" />
		<taxon id="Arctocephalus townsendi" />
		<taxon id="Callorhinus ursinus" />
		<taxon id="Canis latrans" />
		<taxon id="Canis lupus" />
		<taxon id="Cystophora cristata" />
		<taxon id="Enhydra lutris" />
		<taxon id="Erignathus barbatus" />
		<taxon id="Eumetopias jubatus" />
		<taxon id="Felis silvestris" />
		<taxon id="Gulo gulo" />
		<taxon id="Halichoerus grypus" />
		<taxon id="Helarctos malayanus" />
		<taxon id="Herpestes auropunctatus" />
		<taxon id="Hydrurga leptonyx" />
		<taxon id="Leptonychotes weddellii" />
		<taxon id="Lobodon carcinophaga" />
		<taxon id="Lontra canadensis" />
		<taxon id="Lynx canadensis" />
		<taxon id="Martes americana" />
		<taxon id="Martes melampus" />
		<taxon id="Meles meles" />
		<taxon id="Melursus ursinus" />
		<taxon id="Mephitis mephitis" />
		<taxon id="Mirounga angustirostris" />
		<taxon id="Mirounga leonina" />
		<taxon id="Monachus monachus" />
		<taxon id="Monachus schauinslandi" />
		<taxon id="Mustela vison" />
		<taxon id="Neofelis nebulosa" />
		<taxon id="Neophoca cinerea" />
		<taxon id="Odobenus rosmarus" />
		<taxon id="Ommatophoca rossii" />
		<taxon id="Otaria byronia" />
		<taxon id="Panthera pardus" />
		<taxon id="Panthera tigris" />
		<taxon id="Phoca caspica" />
		<taxon id="Phoca fasciata" />
		<taxon id="Phoca groenlandica" />
		<taxon id="Phoca hispida" />
		<taxon id="Phoca largha" />
		<taxon id="Phoca sibirica" />
		<taxon id="Phoca vitulina" />
		<taxon id="Phocarctos hookeri" />
		<taxon id="Procyon lotor" />
		<taxon id="Puma concolor" />
		<taxon id="Spilogale putorius" />
		<taxon id="Taxidea taxus" />
		<taxon id="Tremarctos ornatus" />
		<taxon id="Uncia uncia" />
		<taxon id="Ursus americanus" />
		<taxon id="Ursus arctos" />
		<taxon id="Ursus maritimus" />
		<taxon id="Ursus thibetanus" />
		<taxon id="Vulpes vulpes" />
		<taxon id="Zalophus californianus" /> 
	</taxa>
	
	
	
	<alignment id="alignment" dataType="nucleotide">
		<sequence>
			<taxon idref="Acinonyx jubatus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Ailuropoda melanoleuca" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Ailurus fulgens" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Alopex lagopus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Arctocephalus australis" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Arctocephalus forsteri" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Arctocephalus pusillus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Arctocephalus townsendi" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Callorhinus ursinus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Canis latrans" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Canis lupus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Cystophora cristata" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Enhydra lutris" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Erignathus barbatus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Eumetopias jubatus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Felis silvestris" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Gulo gulo" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Halichoerus grypus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Helarctos malayanus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Herpestes auropunctatus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Hydrurga leptonyx" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Leptonychotes weddellii" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Lobodon carcinophaga" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Lontra canadensis" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Lynx canadensis" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Martes americana" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Martes melampus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Meles meles" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Melursus ursinus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Mephitis mephitis" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Mirounga angustirostris" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Mirounga leonina" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Monachus monachus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Monachus schauinslandi" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Mustela vison" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Neofelis nebulosa" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Neophoca cinerea" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Odobenus rosmarus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Ommatophoca rossii" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Otaria byronia" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Panthera pardus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Panthera tigris" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Phoca caspica" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Phoca fasciata" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Phoca groenlandica" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Phoca hispida" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Phoca largha" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Phoca sibirica" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Phoca vitulina" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Phocarctos hookeri" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Procyon lotor" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Puma concolor" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Spilogale putorius" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Taxidea taxus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Tremarctos ornatus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Uncia uncia" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Ursus americanus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Ursus arctos" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Ursus maritimus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Ursus thibetanus" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Vulpes vulpes" />
			ATG
		</sequence>
		<sequence>
			<taxon idref="Zalophus californianus" />
			ATG
		</sequence>
	</alignment>

	<convert id="codonAlignment" dataType="codon" geneticCode="universal">
        <alignment idref="alignment" />
    </convert>

	<patterns id="patterns" from="1" strip="false" unique="false">
		<alignment idref="codonAlignment" />
	</patterns>



	
	
	<birthDeathModel id="birthDeath" units="substitutions">
		<birthMinusDeathRate>
			<parameter id="birthDeath.BminusDRate" value="1.28" lower="0.0" />
		</birthMinusDeathRate>
		<relativeDeathRate>
			<parameter id="birthDeath.DoverB" value="0.28" lower="0.0" />
		</relativeDeathRate>
	</birthDeathModel>
	
	
	<constantSize id="initialDemo" units="substitutions">
		<populationSize>
			<parameter id="initialDemo.popSize" value="100.0" />
		</populationSize>
	</constantSize>
	
	<newick id="startingTree">
		(((((((('Otaria byronia':0.26252764084965863,('Arctocephalus pusillus':0.2494268002493385,(('Phocarctos hookeri':0.2073771083660727,'Neophoca cinerea':0.2073771083660727):0.021732854718354844,(('Arctocephalus australis':0.05795795702938866,'Arctocephalus forsteri':0.05795795702938866):0.11278240956839203,'Arctocephalus townsendi':0.1707403665977807):0.05836959648664686):0.02031683716491095):0.01310084060032013):0.04935529989523535,('Eumetopias jubatus':0.22154746152871252,'Zalophus californianus':0.22154746152871252):0.09033547921618146):0.23053783201795386,'Callorhinus ursinus':0.5424207727628478):0.6550039349312571,'Odobenus rosmarus':1.197424707694105):0.34494605429336755,((('Cystophora cristata':0.39825099828017696,((((('Halichoerus grypus':0.06907033938241547,'Phoca caspica':0.06907033938241547):0.004213440277439862,'Phoca sibirica':0.07328377965985533):0.004581773729145366,'Phoca hispida':0.0778655533890007):0.013118834682863456,('Phoca largha':0.04839895773157932,'Phoca vitulina':0.04839895773157932):0.042585430340284836):0.21278232607880265,('Phoca fasciata':0.2213427529165497,'Phoca groenlandica':0.2213427529165497):0.0824239612341171):0.09448428412951015):0.2737788785655686,'Erignathus barbatus':0.6720298768457456):0.1773513583309465,(('Monachus schauinslandi':0.509503145624481,'Monachus monachus':0.509503145624481):0.08341206899027886,(((('Hydrurga leptonyx':0.1789604361026449,'Leptonychotes weddellii':0.1789604361026449):0.11122912576649036,'Lobodon carcinophaga':0.29018956186913525):0.03612434485526217,'Ommatophoca rossii':0.3263139067243974):0.1631110120955208,('Mirounga angustirostris':0.09482818385310066,'Mirounga leonina':0.09482818385310066):0.3945967349668176):0.10349029579484159):0.25646602056193224):0.6929895268107804):0.7148064430114622,('Ailuropoda melanoleuca':1.1217211444352535,(((('Helarctos malayanus':0.2840935847306134,('Ursus americanus':0.24005042865437654,'Ursus thibetanus':0.24005042865437654):0.04404315607623688):0.03488186256099213,('Ursus arctos':0.048697732303291996,'Ursus maritimus':0.048697732303291996):0.27027771498831354):0.04071851711376806,'Melursus ursinus':0.3596939644053736):0.5174142059472151,'Tremarctos ornatus':0.8771081703525887):0.2446129740826648):1.1354560605636812):0.2131909175105684,(('Procyon lotor':1.9116311093992202,('Taxidea taxus':1.2807564042110848,((('Gulo gulo':0.6395215565183217,('Martes americana':0.11033795405936497,'Martes melampus':0.11033795405936497):0.5291836024589567):0.41278754916586613,(('Enhydra lutris':0.7577286860795074,'Lontra canadensis':0.7577286860795074):0.1818021406059619,'Mustela vison':0.9395308266854693):0.1127782789987185):0.10936660470765225,'Meles meles':1.16167571039184):0.1190806938192448):0.6308747051881354):0.3114067948075383,(('Mephitis mephitis':0.808536535649484,'Spilogale putorius':0.808536535649484):1.1946766885196065,'Ailurus fulgens':2.0032132241690905):0.21982468003766797):0.2473302183027446):0.31762343357585454,(((((('Acinonyx jubatus':0.36506428963671045,'Puma concolor':0.36506428963671045):0.07931666082859645,'Lynx canadensis':0.4443809504653069):0.0848541978254691,'Felis silvestris':0.529235148290776):0.19754165918035205,('Neofelis nebulosa':0.5294360374551563,(('Panthera pardus':0.28799882951226263,'Uncia uncia':0.28799882951226263):0.10979749583928022,'Panthera tigris':0.39779632535154286):0.13163971210361347):0.19734077001597172):0.9321794071491696,'Herpestes auropunctatus':1.6589562146202976):0.9757536603776222,(('Alopex lagopus':0.37196667928474425,'Vulpes vulpes':0.37196667928474425):0.6339138405601774,('Canis latrans':0.1272607549049829,'Canis lupus':0.1272607549049829):0.8786197649399388):1.6288293551529982):0.15328168108743778);
	</newick>
	
	<treeModel id="treeModel">
		<newick idref="startingTree" />
		<rootHeight>
			<parameter id="treeModel.rootHeight" />
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights" />
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights" />
		</nodeHeights>
	</treeModel>
	
	<speciationLikelihood id="speciation">
		<model>
			<birthDeathModel idref="birthDeath" />
		</model>
		<speciesTree>
			<treeModel idref="treeModel" />
		</speciesTree>
	</speciationLikelihood>
	
	<arbitraryBranchRates id="branchRates" centerAtOne="false">
		<treeModel idref="treeModel" />
		<rates>
            <parameter id="branchRates.rates" value="1E0" lower="0" />
        </rates>
        <scale>
            <parameter id="branchRates.scale" lower="0.0" value="1.0" />
        </scale>
        <location>
            <parameter id="branchRates.location" lower="0.0" value="1E-1" />
        </location>
	</arbitraryBranchRates>

	<rateStatistic id="meanRate" name="meanRate" mode="mean" internal="true" external="true">
		<treeModel idref="treeModel" />
		<arbitraryBranchRates idref="branchRates" />
	</rateStatistic>
	
	<rateStatistic id="coefficientOfVariation" name="coefficientOfVariation" mode="coefficientOfVariation" internal="true" external="true">
		<treeModel idref="treeModel" />
		<arbitraryBranchRates idref="branchRates" />
	</rateStatistic>
	
	<rateCovarianceStatistic id="covariance" name="covariance">
		<treeModel idref="treeModel" />
		<arbitraryBranchRates idref="branchRates" />
	</rateCovarianceStatistic>

	<yangCodonModel id="yang" geneticCode="universal">
        <omega>
            <parameter id="omega" value="1.414" />
        </omega>
        <kappa>
            <parameter id="kappa" value="1.234567" />
        </kappa>
        <frequencyModel id="freqmodel" dataType="codon-universal">
            <alignment idref="codonAlignment" />
            <frequencies>
                <parameter id="codonfrequencies" dimension="61" />
            </frequencies>
        </frequencyModel>
    </yangCodonModel>

	
	<siteModel id="siteModel">
		<substitutionModel>
			<yangCodonModel idref="yang" />
		</substitutionModel>
		<gammaShape gammaCategories="4">
			<parameter id="alpha" value="1.541" lower="0.0" />
		</gammaShape>
	</siteModel>

	<treeDataLikelihood id="treeLikelihood" useAmbiguities="true" usePreOrder="true" scalingScheme="always" delayScaling="false">
		<patterns idref="patterns" />
		<treeModel idref="treeModel" />
		<siteModel idref="siteModel" />
		<arbitraryBranchRates idref="branchRates" />
	</treeDataLikelihood>

	<distributionLikelihood id="ratesPrior">
		<data>
			<parameter idref="branchRates.rates" />
		</data>
		<distribution>
			<logNormalDistributionModel meanInRealSpace="true">
				<mean>
					<parameter value="1.0" lower="0.0" />
				</mean>
				<stdev>
					<parameter value="1.0" lower="0.0" />
				</stdev>
			</logNormalDistributionModel>
		</distribution>
	</distributionLikelihood>
	
	<numericalHessian id="gradient">
	    <branchRateGradient traitName="Sequence" useHessian="false">
    	    <treeDataLikelihood idref="treeLikelihood" />
	    </branchRateGradient>
    </numericalHessian>





	<operators id="operators" optimizationSchedule="log">
		<hamiltonianMonteCarloOperator weight="1" nSteps="4" stepSize="1E-2" mode="vanilla" drawVariance="1.0" autoOptimize="true">
            <jointGradient>
                <hessian>
                    <distributionLikelihood idref="ratesPrior" />
                    <parameter idref="branchRates.rates" />
                </hessian>
                <branchRateGradient id="branchRateGradient" traitName="Sequence">
                    <treeDataLikelihood idref="treeLikelihood" />
                </branchRateGradient>
            </jointGradient>
            <parameter idref="branchRates.rates" />
            <signTransform>
                <parameter idref="branchRates.rates" />
            </signTransform>
        </hamiltonianMonteCarloOperator>
	</operators>
	
	<mcmc id="mcmc" chainLength="10" autoOptimize="true" fullEvaluation="0" preBurnin="0"> 
		<posterior id="posterior">
			<prior id="prior">
				<jeffreysPrior>
					<parameter idref="kappa" />
				</jeffreysPrior>
				<jeffreysPrior>
					<parameter idref="omega" />
				</jeffreysPrior>
				<speciationLikelihood idref="speciation" />
				<distributionLikelihood idref="ratesPrior" />
				<exponentialPrior offset="0" mean="1">
                    <parameter idref="branchRates.scale" />
                </exponentialPrior>
                <exponentialPrior offset="0" mean="1">
                    <parameter idref="branchRates.location" />
                </exponentialPrior>
			</prior>
			
			<likelihood id="likelihood">
				<treeDataLikelihood idref="treeLikelihood" />
			</likelihood> 

		</posterior>
		<operators idref="operators" />
		<log id="screenLog" logEvery="1">
			<column label="Posterior" dp="4" width="12">
				<posterior idref="posterior" />
			</column>
			<column label="Prior" dp="4" width="12">
				<prior idref="prior" />
			</column>
			<column label="Likelihood" dp="4" width="12">
				<likelihood idref="likelihood" />
			</column>
			
			<column label="meanRate" sf="6" width="12">
				<rateStatistic idref="meanRate" />
			</column>
		</log>
	</mcmc>
	
	
	<log id="fileLog" logEvery="1" fileName="carnivores_codon_hmc.log" overwrite="true">
		<posterior idref="posterior" />
		<prior idref="prior" />
		<likelihood idref="likelihood" />
		<rateStatistic idref="meanRate" />
		<rateStatistic idref="coefficientOfVariation" />
		<parameter idref="branchRates.rates" />
	</log>

	<report>
		TIME
		<property name="timer">
			<object idref="mcmc" />
		</property>
	</report>
	
</beast>