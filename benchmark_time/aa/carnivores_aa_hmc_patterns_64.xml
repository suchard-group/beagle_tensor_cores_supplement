<beast>
	

	
	<taxa id="taxa">
		<taxon id="Acinonyx jubatus" />
		<taxon id="Ailuropoda melanoleuca" />
		<taxon id="Ailurus fulgens" />
		<taxon id="Alopex lagopus" />
		<taxon id="Arctocephalus australis" />
		<taxon id="Arctocephalus forsteri" />
		<taxon id="Arctocephalus pusillus" />
		<taxon id="Arctocephalus townsendi" />
		<taxon id="Callorhinus ursinus" />
		<taxon id="Canis latrans" />
		<taxon id="Canis lupus" />
		<taxon id="Cystophora cristata" />
		<taxon id="Enhydra lutris" />
		<taxon id="Erignathus barbatus" />
		<taxon id="Eumetopias jubatus" />
		<taxon id="Felis silvestris" />
		<taxon id="Gulo gulo" />
		<taxon id="Halichoerus grypus" />
		<taxon id="Helarctos malayanus" />
		<taxon id="Herpestes auropunctatus" />
		<taxon id="Hydrurga leptonyx" />
		<taxon id="Leptonychotes weddellii" />
		<taxon id="Lobodon carcinophaga" />
		<taxon id="Lontra canadensis" />
		<taxon id="Lynx canadensis" />
		<taxon id="Martes americana" />
		<taxon id="Martes melampus" />
		<taxon id="Meles meles" />
		<taxon id="Melursus ursinus" />
		<taxon id="Mephitis mephitis" />
		<taxon id="Mirounga angustirostris" />
		<taxon id="Mirounga leonina" />
		<taxon id="Monachus monachus" />
		<taxon id="Monachus schauinslandi" />
		<taxon id="Mustela vison" />
		<taxon id="Neofelis nebulosa" />
		<taxon id="Neophoca cinerea" />
		<taxon id="Odobenus rosmarus" />
		<taxon id="Ommatophoca rossii" />
		<taxon id="Otaria byronia" />
		<taxon id="Panthera pardus" />
		<taxon id="Panthera tigris" />
		<taxon id="Phoca caspica" />
		<taxon id="Phoca fasciata" />
		<taxon id="Phoca groenlandica" />
		<taxon id="Phoca hispida" />
		<taxon id="Phoca largha" />
		<taxon id="Phoca sibirica" />
		<taxon id="Phoca vitulina" />
		<taxon id="Phocarctos hookeri" />
		<taxon id="Procyon lotor" />
		<taxon id="Puma concolor" />
		<taxon id="Spilogale putorius" />
		<taxon id="Taxidea taxus" />
		<taxon id="Tremarctos ornatus" />
		<taxon id="Uncia uncia" />
		<taxon id="Ursus americanus" />
		<taxon id="Ursus arctos" />
		<taxon id="Ursus maritimus" />
		<taxon id="Ursus thibetanus" />
		<taxon id="Vulpes vulpes" />
		<taxon id="Zalophus californianus" /> 
	</taxa>
	
	
	
	<alignment id="alignment" dataType="amino acid">
		<sequence>
			<taxon idref="Acinonyx jubatus" />
			MNENLFASFITPTMMGLPIVMLIIMFPSILFPSPNRLINNRLISLQQWLVQLTSKQMLAIHNYK
		</sequence>
		<sequence>
			<taxon idref="Ailuropoda melanoleuca" />
			MNENLFASFTTPMMMGVPIVVLIIIFPSILFPSPNRLINNRLATVQQWLIQLVSKYMLSIHNYK
		</sequence>
		<sequence>
			<taxon idref="Ailurus fulgens" />
			MNENLFASFTTPTLMGLPIVILIIMLPSILFPSSNRLTNNRLISIQQWLLKLTSKQMLSTHNYE
		</sequence>
		<sequence>
			<taxon idref="Alopex lagopus" />
			MNENLFASFATPTMMGLPIAVLIVMFPSILFPSPNRLINNRLISIQQWLIQLTSKQMLMIHNQK
		</sequence>
		<sequence>
			<taxon idref="Arctocephalus australis" />
			MNENLFTSFASPTMMGLPIVTLIILFPSMLFPSPGRLINNRFTSIQQWLIQLTSKQMMLIHNHK
		</sequence>
		<sequence>
			<taxon idref="Arctocephalus forsteri" />
			MNENLFTSFASPTMMGLPIVTLIILFPSMLFPSPGRLINNRFTSIQQWLIQLTSKQMMLIHNHK
		</sequence>
		<sequence>
			<taxon idref="Arctocephalus pusillus" />
			MNENLFTSFTSPTMMGLPIVTLVILFPSMLFPSPGRLINNRFTSIQQWLIQLTSKQMMMIHNHK
		</sequence>
		<sequence>
			<taxon idref="Arctocephalus townsendi" />
			MNENLFTSFASPTMMGLPVVTLIILFPSMLFPSPGRLINNRLTSIQQWLIQLTSKQMMSIHNRK
		</sequence>
		<sequence>
			<taxon idref="Callorhinus ursinus" />
			MHENLFASFTSPTMMGLPIVTLIILFPSMLFPSPNQLISNRLTSIQQWLIQLMSKQMMSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Canis latrans" />
			MNENLFASFAAPSMMGLPIVVLIVMFPSILFPAPNRLINNRLISIQQWLIQLTSKQMLAIHNQK
		</sequence>
		<sequence>
			<taxon idref="Canis lupus" />
			MNENLFASFAAPSMMGLPIVVLIVMFPSILFPTPSRLINNRLISIQQWLIQLTSKQMLAIHNQK
		</sequence>
		<sequence>
			<taxon idref="Cystophora cristata" />
			MNENLFTSFAAPTMMGLPIVLLITLFPSILFPSPDRLINNRLASIQQWLIQLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Enhydra lutris" />
			MNENLFSSFITPVVMGLPIVIAIVMFPSIMFPSPSRLINNRLISIQQWLVQLTSKQMLSIHNQK
		</sequence>
		<sequence>
			<taxon idref="Erignathus barbatus" />
			MNENLFASFTTPTMMGLPIVILIILFPSILFPSPNRLVNNRLTSIQQWLIQLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Eumetopias jubatus" />
			MNENLFTSFASPTMMGLPIVTLVILFPSMLFPSPSRLINNRLTSIQQWLIQLTSKQMMLMHNHK
		</sequence>
		<sequence>
			<taxon idref="Felis silvestris" />
			MNENLFASFTTPTMMGLPIVILIIMFPSILFPSPNRLINNRLVSLQQWLVQLTSKQMLAIHNHK
		</sequence>
		<sequence>
			<taxon idref="Gulo gulo" />
			MNENLFSSFITPTMMGLPIVILITMFPGIMFPSPSRLINNRLISIQQWLVQLTSKQMLSVHNQK
		</sequence>
		<sequence>
			<taxon idref="Halichoerus grypus" />
			MNENLFASFTTPTMMGLPIVILIVLFPSILFPSPDRLINNRLTSIQQWLIQLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Helarctos malayanus" />
			MNENLFTSFITPTMMGIPVVVLIVMSPSILFPSPSRLIDNRLVSIQQWLVRLTSKQMLSTHNHK
		</sequence>
		<sequence>
			<taxon idref="Herpestes auropunctatus" />
			MNENLFASFTTPTMMGLPVVILIIMFPSIMFPAPNRLINNRLISLQQWLIQLTSKQMLAIHNHK
		</sequence>
		<sequence>
			<taxon idref="Hydrurga leptonyx" />
			MNENLFASFTTPTMMGLPIVILIILFPSILFPSPNRLVNNRLISIQQWLIQLTSKQLLSIHNYK
		</sequence>
		<sequence>
			<taxon idref="Leptonychotes weddellii" />
			MNENLFASFTTPTMMGLPIVILIILFPSILFPSPNRLINNRLISIQQWLIQLTSKQMLSIHNYK
		</sequence>
		<sequence>
			<taxon idref="Lobodon carcinophaga" />
			MNENLFASFTTPTMMGLPIVILIILFPSILFPSPNRLINNRLISIQQWLIQLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Lontra canadensis" />
			MNENLFSSFITPMMMGLPVVVVIVMFPSIMFPSPSRLINNRLISIQQWLVQLTSKQMLSIHNQK
		</sequence>
		<sequence>
			<taxon idref="Lynx canadensis" />
			MNENLFASFTTPTMMGLPVVILIIMFPSILFPSPNRLINNRLISLQQWLVQLTSKQMLAIHNHK
		</sequence>
		<sequence>
			<taxon idref="Martes americana" />
			MNENLFSSFITPTMMGLPIVIAITMFPSIMFPSPNRLINNRLISIQQWLVQLTSKQMLSIHNQK
		</sequence>
		<sequence>
			<taxon idref="Martes melampus" />
			MNENLFSSFITPTMMGLPIVIAITMFPSIMFPSPTRLINNRLISIQQWLVQLTSKQMLSIHNQK
		</sequence>
		<sequence>
			<taxon idref="Meles meles" />
			MNENLFSSFITPTMMGLPIVVMIIMFPSILFPSPNRLINNRLISIQQWLVQLTSKQMLSIHNQK
		</sequence>
		<sequence>
			<taxon idref="Melursus ursinus" />
			MNENLFTSFTTPTMMGIPIVVLIVMFPSLLFPSPSRLINNRLVSIQQWLVRLTSKQMLSTHNHK
		</sequence>
		<sequence>
			<taxon idref="Mephitis mephitis" />
			MNENLFASFTTPTMIGLPIVIIIVLFPSILFPTSNRLINNRLISIQQWLVQLTSKQMLSIHNNK
		</sequence>
		<sequence>
			<taxon idref="Mirounga angustirostris" />
			MNENLFTSFATPTMMGLPIVILIILFPSILFPSPDRLINNRLISIQQWLIQLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Mirounga leonina" />
			MNENLFTSFATPTMMGLPIVILVILFPSILFPSPDRLINNRLTSIQQWLIQLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Monachus monachus" />
			MNENLFASFTIPTMIGLPIVILIILFPSILFPSPDRLINNRLTSIQQWLIQLTSKQMLSTHNYK
		</sequence>
		<sequence>
			<taxon idref="Monachus schauinslandi" />
			MNENLFASFATPTMMGLPIVILITLFPSILLPSPDRLINNRLISIQQWLIQLTSKQMLSVHNYK
		</sequence>
		<sequence>
			<taxon idref="Mustela vison" />
			MNENLFSSFITPTMMGLPIVIIITMFPSIMFPSPTRLINNRLISIQQWLVQLTSKQMLSIHNQK
		</sequence>
		<sequence>
			<taxon idref="Neofelis nebulosa" />
			MNENLFASFTTPTMMGLPIVVLIIMFPSILFPSPNRLVNNRLVSLQQWLVQLTSKQMLAIHNHK
		</sequence>
		<sequence>
			<taxon idref="Neophoca cinerea" />
			MNENLFTSFASPTMMGLPIVTLIILFPSALFPSPGRLINNRFTSIQQWLVQLTSKQMMMIHNHK
		</sequence>
		<sequence>
			<taxon idref="Odobenus rosmarus" />
			MNENLFTSFTSPTMMGFPVVMLIILFPSIMFPSPDRLINNRLASIQQWLIQLTSKQMMSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Ommatophoca rossii" />
			MNENLFASFTTPTMMGLPIVILIILFPSVLFPSPNRLINNRLISIQQWLIQLTSKQMLSIHNYK
		</sequence>
		<sequence>
			<taxon idref="Otaria byronia" />
			MNENLFTSFTSPTMMGLPIVTLIILFPSMLFPSPGRLISNRFTSIQQWLIQLTSKQMMAIHNHK
		</sequence>
		<sequence>
			<taxon idref="Panthera pardus" />
			MNENLFTSFTTPTMMGLPIVVLIIMFPSILFPSPNRLINNRLVSLQQWLVQLTSKQMLAIHSHK
		</sequence>
		<sequence>
			<taxon idref="Panthera tigris" />
			MNENLFTSFTTPTMMGLPVVVLIVMFPSILFPSPNRLINNRLVSLQQWLVQLTLKQMLITHNYK
		</sequence>
		<sequence>
			<taxon idref="Phoca caspica" />
			MNENLFASFATPTMMGLPIVVLIVLFPSILFPSPDRLINNRLTSIQQWLIQLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Phoca fasciata" />
			MNENLFASFTTPTMMGLPIVILIVLFPSILFPSPDRLINNRLASIQQWLIQLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Phoca groenlandica" />
			MNENLFASFAAPTMMGLPIVILIVLFPSILFPSPDRLINNRLASIQQWLIQLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Phoca hispida" />
			MNENLFASFTTPTMMGLPVVILIVLFPSILFPSPDRLINNRLASIQQWLIQLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Phoca largha" />
			MNENLFASFATPTMMGLPIVILIILFPSILFPSPDRLINNRLTSIQQWLIQLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Phoca sibirica" />
			MNENLFASFAAPTMMGLPIVILIVLFPSILFPSPDRLINNRLASIQQWLIQLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Phoca vitulina" />
			MNENLFASFATPTMMGLPIVILIVLFPSILFPSPDRLINNRLASIQQWLIQLTSKQMLSIHNRK
		</sequence>
		<sequence>
			<taxon idref="Phocarctos hookeri" />
			MNENLFTSFASPAMMGLPIVTLIILFPSILFPSPSRLVNNRFTSIQQWLIQLTSKQMMLIHNHK
		</sequence>
		<sequence>
			<taxon idref="Procyon lotor" />
			MNENLFSSFTTPTMMGLPLIILITMAPSILFPSPARLINNRFISIQQWLICLVSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Puma concolor" />
			MNENLFASFATPTMMGLPIVILIVMFPSILFPSPNRLINNRLISLQQWLVQLTSKQMLAIHNHK
		</sequence>
		<sequence>
			<taxon idref="Spilogale putorius" />
			MNENLFTSFTTPTMIGLPIVVIIIMFPSIFFPSPNRLVNNRLISIQQWLVQLMSKQMLSIHNNK
		</sequence>
		<sequence>
			<taxon idref="Taxidea taxus" />
			MNENLFSSFITPTMMGLPIVVIITMFPSILFPSPNRLVPNRLISIQQWLVQLTSKQMLSIHSSK
		</sequence>
		<sequence>
			<taxon idref="Tremarctos ornatus" />
			MNENLFASFTTPTMMGVPIVVLIIVFPSILFPSPSRLINNRLISTQQWLVQLTLKQMLSIHNYK
		</sequence>
		<sequence>
			<taxon idref="Uncia uncia" />
			MNENLFTSFTTPTMMGLPIVVLIIMFPSILFPSPNRLINNRLVSLQQWLVQLTSKQMLAIHNRK
		</sequence>
		<sequence>
			<taxon idref="Ursus americanus" />
			MNESLFTSFITPTMMGIPIVVLIIMFPSILFPSPSRLVNNRLVSIQQWLVRLTSKQMLSIHNHK
		</sequence>
		<sequence>
			<taxon idref="Ursus arctos" />
			MNENLFTSFITPTMVGIPIVLLIIMFPSILFPSPSRLIDNRLVSIQQWLVRLTSKQMLSIHSHK
		</sequence>
		<sequence>
			<taxon idref="Ursus maritimus" />
			MNENLFTSFITPTMVGIPIVPLIIMFPSILFPSPSRLIDNRLVSIQQWLVRLTSKQMLSIHSHK
		</sequence>
		<sequence>
			<taxon idref="Ursus thibetanus" />
			MNENLFTSFITPTMMGVPIVVLIVMFPSILFPSPSRLIDNRLVSIQQWLVWLTSKQMLSIHNRK
		</sequence>
		<sequence>
			<taxon idref="Vulpes vulpes" />
			MNENLFASFATPTMMGLPIAVLIVMFPSILFPSPNRLINNRLISIQQWLIQLTSKQMLTIHNQK
		</sequence>
		<sequence>
			<taxon idref="Zalophus californianus" />
			MNENLFTSFTSPTMMGLPIVTLIILFPSMLFPSPGRLINNRLTSIQQWLIQLTSKQMMLIHNHK
		</sequence>
	</alignment>



	
	
	<patterns id="patterns" from="1" strip="false" unique="false">
		<alignment idref="alignment" />
	</patterns>
	
	
	
	<birthDeathModel id="birthDeath" units="substitutions">
		<birthMinusDeathRate>
			<parameter id="birthDeath.BminusDRate" value="1.28" lower="0.0" />
		</birthMinusDeathRate>
		<relativeDeathRate>
			<parameter id="birthDeath.DoverB" value="0.28" lower="0.0" />
		</relativeDeathRate>
	</birthDeathModel>
	
	
	<constantSize id="initialDemo" units="substitutions">
		<populationSize>
			<parameter id="initialDemo.popSize" value="100.0" />
		</populationSize>
	</constantSize>
	
	
	
	<coalescentSimulator id="startingTree">
		<taxa idref="taxa" />
		<constantSize idref="initialDemo" />
	</coalescentSimulator>
	
	<treeModel id="treeModel">
		<newick idref="startingTree" />
		<rootHeight>
			<parameter id="treeModel.rootHeight" />
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights" />
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights" />
		</nodeHeights>
	</treeModel>
	
	<speciationLikelihood id="speciation">
		<model>
			<birthDeathModel idref="birthDeath" />
		</model>
		<speciesTree>
			<treeModel idref="treeModel" />
		</speciesTree>
	</speciationLikelihood>
	
	<arbitraryBranchRates id="branchRates" centerAtOne="false">
		<treeModel idref="treeModel" />
		<rates>
            <parameter id="branchRates.rates" value="1E0" lower="0" />
        </rates>
        <scale>
            <parameter id="branchRates.scale" lower="0.0" value="1.0" />
        </scale>
        <location>
            <parameter id="branchRates.location" lower="0.0" value="1E-1" />
        </location>
	</arbitraryBranchRates>

	<rateStatistic id="meanRate" name="meanRate" mode="mean" internal="true" external="true">
		<treeModel idref="treeModel" />
		<arbitraryBranchRates idref="branchRates" />
	</rateStatistic>
	
	<rateStatistic id="coefficientOfVariation" name="coefficientOfVariation" mode="coefficientOfVariation" internal="true" external="true">
		<treeModel idref="treeModel" />
		<arbitraryBranchRates idref="branchRates" />
	</rateStatistic>
	
	<rateCovarianceStatistic id="covariance" name="covariance">
		<treeModel idref="treeModel" />
		<arbitraryBranchRates idref="branchRates" />
	</rateCovarianceStatistic>

	<aminoAcidModel id="amino" type="WAG" />
	
	
	<siteModel id="siteModel">
		<substitutionModel>
			<aminoAcidModel idref="amino" />
		</substitutionModel>
		<gammaShape gammaCategories="4">
			<parameter id="alpha" value="1.541" lower="0.0" />
		</gammaShape>
	</siteModel>

	<treeDataLikelihood id="treeLikelihood" useAmbiguities="true" usePreOrder="true" scalingScheme="always" delayScaling="false">
		<patterns idref="patterns" />
		<treeModel idref="treeModel" />
		<siteModel idref="siteModel" />
		<arbitraryBranchRates idref="branchRates" />
	</treeDataLikelihood>

	<distributionLikelihood id="ratesPrior">
		<data>
			<parameter idref="branchRates.rates" />
		</data>
		<distribution>
			<logNormalDistributionModel meanInRealSpace="true">
				<mean>
					<parameter value="1.0" lower="0.0" />
				</mean>
				<stdev>
					<parameter value="1.0" lower="0.0" />
				</stdev>
			</logNormalDistributionModel>
		</distribution>
	</distributionLikelihood>
	
	<numericalHessian id="gradient">
	    <branchRateGradient traitName="Sequence" useHessian="false">
    	    <treeDataLikelihood idref="treeLikelihood" />
	    </branchRateGradient>
    </numericalHessian>





	<operators id="operators" optimizationSchedule="log">
		<hamiltonianMonteCarloOperator weight="1" nSteps="4" stepSize="1E-2" mode="vanilla" drawVariance="1.0" autoOptimize="true">
            <jointGradient>
                <hessian>
                    <distributionLikelihood idref="ratesPrior" />
                    <parameter idref="branchRates.rates" />
                </hessian>
                <branchRateGradient id="branchRateGradient" traitName="Sequence">
                    <treeDataLikelihood idref="treeLikelihood" />
                </branchRateGradient>
            </jointGradient>
            <parameter idref="branchRates.rates" />
            <signTransform>
                <parameter idref="branchRates.rates" />
            </signTransform>
        </hamiltonianMonteCarloOperator>
	</operators>
	
	<mcmc id="mcmc" chainLength="10" autoOptimize="true" fullEvaluation="0" preBurnin="0"> 
		<posterior id="posterior">
			<prior id="prior">
				<speciationLikelihood idref="speciation" />
				<distributionLikelihood idref="ratesPrior" />
				<exponentialPrior offset="0" mean="1">
                    <parameter idref="branchRates.scale" />
                </exponentialPrior>
                <exponentialPrior offset="0" mean="1">
                    <parameter idref="branchRates.location" />
                </exponentialPrior>
			</prior>
			
			<likelihood id="likelihood">
				<treeDataLikelihood idref="treeLikelihood" />
			</likelihood> 

		</posterior>
		<operators idref="operators" />
		<log id="screenLog" logEvery="1">
			<column label="Posterior" dp="4" width="12">
				<posterior idref="posterior" />
			</column>
			<column label="Prior" dp="4" width="12">
				<prior idref="prior" />
			</column>
			<column label="Likelihood" dp="4" width="12">
				<likelihood idref="likelihood" />
			</column>
			
			<column label="meanRate" sf="6" width="12">
				<rateStatistic idref="meanRate" />
			</column>
		</log>
	</mcmc>


	
	
	<log id="fileLog" logEvery="1" fileName="carnivores_aa_hmc.log" overwrite="true">
		<posterior idref="posterior" />
		<prior idref="prior" />
		<likelihood idref="likelihood" />
		<rateStatistic idref="meanRate" />
		<rateStatistic idref="coefficientOfVariation" />
		<parameter idref="branchRates.rates" />
	</log>

	<report>
		TIME
		<property name="timer">
			<object idref="mcmc" />
		</property>
	</report>
	

</beast>